# k-bonacci递推系统

## 1.1 k-bonacci序列的定义

**定义 1.1（k-bonacci递推）**：k-bonacci序列 $\{F_n^{(k)}\}$ 满足递推关系：
$$F_n^{(k)} = F_{n-1}^{(k)} + F_{n-2}^{(k)} + \cdots + F_{n-k}^{(k)}$$

初始条件：
$$F_i^{(k)} = \begin{cases}
0 & \text{若 } i < 0 \\
1 & \text{若 } i = k-1 \\
0 & \text{若 } 0 \leq i < k-1
\end{cases}$$

**定理 1.1（特征方程）**：k-bonacci递推的特征方程为：
$$r^k = r^{k-1} + r^{k-2} + \cdots + r + 1$$

即：
$$r^k - r^{k-1} - r^{k-2} - \cdots - r - 1 = 0$$

*证明*：设 $F_n^{(k)} = r^n$，代入递推关系得到特征方程。$\square$

**定理 1.2（主导特征根）**：特征方程有唯一的正实根 $r_k > 1$。

*证明*：
1. 定义 $f(r) = r^k - r^{k-1} - \cdots - r - 1$
2. $f(1) = 1 - 1 - \cdots - 1 - 1 = -k < 0$
3. $f(2) = 2^k - 2^{k-1} - \cdots - 2 - 1 = 2^{k-1} - 1 > 0$
4. $f(r)$ 连续单调递增（当 $r > 1$）
5. 由中间值定理，存在唯一根 $r_k \in (1, 2)$

$\square$

## 1.2 特征根的性质

**定理 1.3（特征根的单调性）**：特征根 $r_k$ 随 $k$ 单调递增。

*证明*：
设 $g_k(r) = r^k - \sum_{i=1}^{k} r^{k-i}$，则：
$$g_{k+1}(r) = r \cdot g_k(r) - r^{k-1}$$

对于 $r > 1$，$g_{k+1}(r) < g_k(r)$，因此 $r_{k+1} > r_k$。$\square$

**定理 1.4（特征根的渐近行为）**：
$$\lim_{k \to \infty} r_k = 2$$

*证明*：
1. 当 $k \to \infty$ 时，特征方程近似为：$r^k = \sum_{i=1}^{k} r^{k-i} \approx \frac{r^k}{1-1/r}$
2. 简化得：$1 - 1/r = 1$，即 $r = 2$
3. 严格证明使用级数收敛理论

$\square$

**推论 1.1（具体值）**：
- $r_1 = 1$（退化情况）
- $r_2 = \phi = \frac{1+\sqrt{5}}{2} \approx 1.618$（黄金比例）
- $r_3 \approx 1.839$（Tribonacci常数）
- $r_4 \approx 1.928$

## 1.3 k-bonacci数列与组合计数

**定理 1.5（组合解释）**：$F_n^{(k)}$ 等于长度为 $n$ 且不包含连续 $k$ 个1的二进制序列数量。

*证明*：
设 $a_n$ 为所求序列数量，则：
- 若序列以0结尾：有 $a_{n-1}$ 种
- 若序列以1结尾但不违反no-k约束：有 $a_{n-1} + a_{n-2} + \cdots + a_{n-k}$ 种

因此 $a_n = a_{n-1} + a_{n-2} + \cdots + a_{n-k}$，与k-bonacci递推一致。$\square$

**定理 1.6（避免模式计数）**：k-bonacci数列计算避免特定模式的序列数量。

*证明*：避免连续k个1的模式 $1^k$ 的序列计数正是k-bonacci递推的组合意义。$\square$

## 1.4 预测序列的递推结构

**定义 1.2（预测递推）**：观察者的预测序列 $(p_n)$ 基于k-bonacci递推：
$$p_n \equiv p_{n-1} + p_{n-2} + \cdots + p_{n-k} \pmod{M}$$

其中 $M$ 是适当选择的模数。

**定理 1.7（模运算的周期性）**：在模 $M$ 下，预测序列具有周期性。

*证明*：
1. 序列状态由 $(p_{n-k+1}, \ldots, p_n)$ 决定
2. 状态空间大小为 $M^k$
3. 由鸽笼原理，序列必然周期
4. 周期长度最大为 $M^k$

$\square$

**定理 1.8（素数模的优势）**：选择素数 $p$ 作为模数最大化序列周期。

*证明*：
1. 在素数域 $\mathbb{F}_p$ 中，非零元素形成乘法群
2. k-bonacci递推的线性性在域中保持
3. 素数模避免零因子，保证可逆性
4. 最大周期接近 $p^k - 1$

$\square$

## 1.5 递推的矩阵表示

**定义 1.3（伴随矩阵）**：k-bonacci递推的伴随矩阵为：
$$A_k = \begin{pmatrix}
0 & 1 & 0 & \cdots & 0 \\
0 & 0 & 1 & \cdots & 0 \\
\vdots & \vdots & \vdots & \ddots & \vdots \\
0 & 0 & 0 & \cdots & 1 \\
1 & 1 & 1 & \cdots & 1
\end{pmatrix}$$

**定理 1.9（矩阵递推）**：
$$\begin{pmatrix} F_{n+1}^{(k)} \\ F_{n}^{(k)} \\ \vdots \\ F_{n-k+2}^{(k)} \end{pmatrix} = A_k \begin{pmatrix} F_{n}^{(k)} \\ F_{n-1}^{(k)} \\ \vdots \\ F_{n-k+1}^{(k)} \end{pmatrix}$$

*证明*：直接验证矩阵乘法。$\square$

**定理 1.10（特征值谱）**：$A_k$ 的特征值为特征方程的所有根。

*证明*：$A_k$ 的特征多项式正是k-bonacci特征方程。$\square$

**定理 1.11（渐近公式）**：
$$F_n^{(k)} \sim \frac{r_k^n}{\alpha_k}$$

其中 $\alpha_k$ 是归一化常数，$r_k$ 是主导特征根。

*证明*：使用线性递推的渐近理论。$\square$

## 1.6 递推系统的计算复杂度

**定理 1.12（计算复杂度）**：计算 $F_n^{(k)}$ 的时间复杂度为 $O(k \log n)$。

*证明*：
1. 直接递推：$O(kn)$
2. 矩阵快速幂：$O(k^3 \log n)$
3. 特征根公式：$O(k \log n)$（最优）

$\square$

**定理 1.13（空间复杂度）**：空间复杂度为 $O(k)$。

*证明*：只需存储最近 $k$ 个值即可继续递推。$\square$

**定理 1.14（递推系统的完备性）**：k-bonacci递推系统完全刻画了no-k约束下的序列结构。

*证明*：
1. 每个满足no-k约束的序列对应唯一的k-bonacci表示
2. k-bonacci递推生成所有可能的合法序列
3. 特征根 $r_k$ 确定序列的渐近增长率
4. 系统提供完整的组合刻画

因此递推系统是no-k约束的数学实现。$\square$